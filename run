#!/usr/bin/env php
<?php

if (!isset($argv[1])) {
    echo "Starting codeworker PHP server ...\n";
    echo exec('php -S localhost:80');

} elseif ($argv[1] && is_numeric($argv[1])) {
    echo "Starting codeworker PHP server ...\n";
    echo exec('php -S localhost:' . $argv[1]);

} elseif ($argv[1] && $argv[1] == '-h') {
    $helpf = fopen('run.help.txt', 'r');
    $text = fread($helpf, filesize('run.help.txt'));
    
    echo $text;
}

/* 
* ------------------------------------------
* ----------------------------- :: RUN
* ------------------------------------------ 
*/

function controller($action = [])
{
    foreach ($action as $key => $value) {
        if ($key == 'makeDefault') {
            $fcontroller = fopen('app/Controllers/'.$value.'.php', 'w');
            $content = 
"<?php

    # Developing

    function show()
    {
        global \$db;
    }

?>";

            fwrite($fcontroller, $content);
            fclose($fcontroller);
        }
    }
}

if ($argv[1] && $argv[1] == 'controller:file') {
    controller(['makeDefault' => $argv[2]]);
    echo 'Controller created successfully.';
}